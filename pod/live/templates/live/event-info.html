{% load i18n %}
{% load staticfiles %}
{% load tagging_tags %}
{% load thumbnail %}

<div class="tab-content w-100" id="video-meta">
  {% if event.description %}
    <div class="tab-pane fade active show" id="summary" role="tabpanel" aria-labelledby="summary-tab">
      <h2 class="tab-title"><i data-feather="align-justify"></i>&nbsp;{% trans 'Summary' %}</h2>
      <hr/>
      <p>{{ event.description|safe }}</p>
    </div>
  {% endif %}

  <div id="info" role="tabpanel" aria-labelledby="info-tab"
    {% if not event.description %}
      class="tab-pane fade active show"
    {% else %}
      class="tab-pane fade"
    {% endif %}
  >
    <h2 class="tab-title"><i data-feather="info"></i>&nbsp;{% trans 'Infos' %}</h2>
    <hr/>
    <ul class="list-inline d-flex flex-wrap">
      <li class="col-6 col-md-4">
        <h3 class="meta-title">{% trans 'Broadcasted on:' %}</h3>
        <div>{% blocktrans with start_date=event.start_date|date:"d/m/Y" start_time=event.start_time end_time=event.end_time %}{{start_date}} from {{start_time}} to {{end_time}}{% endblocktrans %}
        </div>
      </li>
      <li class="col-6 col-md-4">
        <h3 class="meta-title">{% trans 'Location:' %}</h3>
        <div>{{ event.broadcaster.building.name }} - {{ event.broadcaster.name }}
        </div>
      </li>
      <li class="col-6 col-md-4">
        <h3 class="meta-title">{% trans 'Added by:' %}</h3>
        <div>
          <a href="{% url 'videos' %}?owner={{ event.owner.username }}" title="{{ event.owner.get_full_name }}" {% if request.GET.is_iframe %}target="_blank"{% endif %}>
          {% if event.owner.owner.userpicture.file %}
            {% thumbnail event.owner.owner.userpicture.file "x50" as im %}
              <img src="{{ im.url }}" width="{{ im.width }}" height="{{ im.height }}" class='rounded' alt="{{ event.owner.get_full_name }}" loading="lazy">
            {% endthumbnail %}
          {% endif %}
          {{ event.owner.get_full_name }}</a>
        </div>
      </li>

{#      <li class="col-6 col-md-4">#}
{#        <h3 class="meta-title">{% trans 'Number of views:' %}</h3>#}
{#        <div>#}
{#        </div>#}
{#      </li>#}

      <li class="col-6 col-md-4">
        <h3 class="meta-title">{% trans 'Type:' %}</h3>
        <div><a href="{% url 'videos' %}?type={{ event.type.slug }}" {% if request.GET.is_iframe %}target="_blank"{% endif %}>{{ event.type.title }}</a></div>
      </li>
    </ul>
  </div>

    {% if event.is_draft == False or event.owner == request.user or request.user in event.additional_owners.all or request.user.is_superuser %}
    <div class="tab-pane fade" id="share" role="tabpanel" aria-labelledby="share-tab" {% if event.is_draft %}style="border:1px solid red"{% endif %}>
      <h2 class="tab-title"><i data-feather="share-2"></i>&nbsp;{% if event.is_draft %}{% trans 'Embed/Share (Draft Mode)' %}{% else %}{% trans 'Embed/Share' %}{%endif%}</h2>
      <hr/>
      {% if event.is_draft %}
        <div class="card text-white bg-danger mb-3">
          <div class="card-body">
          {% blocktrans %}Please note that your event is in draft mode.<br/>The following links contain a key allowing access. Anyone with this links can access it.{% endblocktrans %}
          </div>
        </div>
      {% endif %}

      <div class="row">
        <div class="col-md-6">
          <fieldset>
            <legend><i data-feather="code"></i>&nbsp;{% trans 'Embed in a web page' %}</legend>
            <div class="form-group ">
              <label for="txtintegration">{% trans 'Copy the content of this text box and paste it in the page:' %}</label>
              <textarea name="txtintegration" id="txtintegration" class="form-control" rows="4">&lt;iframe src="{% if request.is_secure %}https{% else %}http{% endif %}://{{ request.META.HTTP_HOST }}{% url 'live:event' slug=event.slug %}{% if event.is_draft == True %}{{ event.get_hashkey }}/{% endif %}?is_iframe=true" width="640" height="360" style="padding: 0; margin: 0; border:0" allowfullscreen &gt;&lt;/iframe&gt;</textarea>
            </div>
          </fieldset>
          {% if not event.is_draft and not event.broadcaster.is_restricted %}
            <dl class="row">
              <dt class="col-sm-3 text-right">{% trans 'Social Networks' %}</dt>
              <dd class="col-sm-9 mb-0">
                <ul class="list-inline mb-0 social_links">
                  <li class="list-inline-item"><a target="_blank" href="https://www.facebook.com/sharer.php?u={{request.build_absolute_uri|urlencode}}" class="btn btn-outline-primary btn-sm m-1" title="{% trans 'Share on' %} Facebook"><i data-feather="facebook"></i></a></li>
                  <li class="list-inline-item"><a target="_blank" href="https://twitter.com/share?url={{request.build_absolute_uri|urlencode}}" class="btn btn-outline-primary btn-sm m-1" title="{% trans 'Share on' %} Twitter"><i data-feather="twitter"></i></a></li>
                  <li class="list-inline-item"><a target="_blank" href="https://www.linkedin.com/shareArticle?mini=true&url={{request.build_absolute_uri|urlencode}}" class="btn btn-outline-primary btn-sm m-1" title="{% trans 'Share on' %} LinkedIn"><i data-feather="linkedin"></i></a></li>
                </ul>
              </dd>
            </dl>
          {% endif %}
        </div>
        <div class="col-md-6">
          <fieldset>
            <legend><i data-feather="link"></i>&nbsp;{% trans 'Share the link' %}</legend>
            <div class="form-group">
              <label for="txtpartage">{% trans 'Use this link to share the video:' %}</label>
              <input class="form-control" type="text" name="txtpartage" id="txtpartage" value="{% if request.is_secure %}https{% else %}http{% endif %}://{{ request.META.HTTP_HOST }}{% url 'live:event' slug=event.slug %}{% if event.is_draft == True %}{{ event.get_hashkey }}/{% endif %}" />
            </div>
            <div class="form-group">
              <label>{% trans 'QR code for this link:' %}</label>
              <img src="//chart.apis.google.com/chart?cht=qr&chs=200x200&chl={% if request.is_secure %}https{% else %}http{% endif %}://{{ request.META.HTTP_HOST }}{% url 'live:event' slug=event.slug %}{% if event.is_draft == True %}{{ event.get_hashkey }}/{% endif %}" alt="qrcode" id="qrcode" loading="lazy"/>
            </div>
          </fieldset>
        </div>
      </div>
    </div>
  {%endif%}
</div>