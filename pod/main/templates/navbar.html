{% load staticfiles %}
{% load i18n %}
{% get_current_language as LANGUAGE_CODE %}
{% get_available_languages as LANGUAGES %}
{% get_language_info_list for LANGUAGES as languages %}

{% spaceless %}
<div class="container">
  <div>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <i data-feather="menu" aria-hidden="true"></i>
    </button>
    <a class="navbar-brand mr-0 mr-sm-1" href="/"><img src="{% static LOGO_SITE %}" height="48" alt="logo"/><strong>{{ TITLE_SITE }}</strong></a>
  </div>

  <div class="collapse navbar-collapse bg-light navbar-items-pod" id="navbarSupportedContent">
    <ul class="navbar-nav mr-auto">
      <li class="nav-item">
        <button class="nav-link" href="#" data-toggle="modal" data-target=".chaines-modal"><i data-feather="youtube" aria-hidden="true" class="nav-link-icone d-lg-none d-xl-inline"></i> {% trans "Channels" %}</button>
      </li>
      <li class="nav-item">
        <button class="nav-link" href="#" data-toggle="modal" data-target=".users-modal"><i data-feather="users" aria-hidden="true" class="nav-link-icone d-lg-none d-xl-inline"></i> {% trans "Users"%}</button>
      </li>
       <li class="nav-item">
        <button class="nav-link" href="#" data-toggle="modal" data-target=".types-modal"><i data-feather="tv" aria-hidden="true" class="nav-link-icone d-lg-none d-xl-inline"></i> {% trans "Types"%}</button>
      </li>
      {% if "live" in THIRD_PARTY_APPS %}
      <li class="nav-item">
        <a class="nav-link" href="{% url 'live:lives'%}"><i data-feather="radio" aria-hidden="true" class="nav-link-icone d-lg-none d-xl-inline"></i> {% trans "Lives"%}</a>
      </li>
      {% endif %}
      <li class="nav-item d-flex d-block d-lg-none langs pt-2 mt-2 justify-content-between">
        <button class="active">{{LANGUAGE_CODE}}</button>
        {% for language in languages %}
        {% if language.code != LANGUAGE_CODE %}
        <form class="form form-inline p-0 m-0" action="/i18n/setlang/" method="post">
          {% csrf_token %}
          <input name="language" value="{{ language.code }}" type="hidden">
          <input value="{{ language.name_local }} ({{ language.code }})" class="btn btn-lang my-2 mr-sm-2" type="submit">
        </form>
        {% endif %}
        {% endfor %}
      </li>
    </ul>
  </div>
  <form class="form-inline my-2 my-lg-0 justify-content-center flex-2">
    <label for="s" class="d-lg-none">
      <i data-feather="search" class="nav-link-icone"></i> <span class="sr-only">{% trans "Search" %}</span> 
    </label>
    <input class="form-control mr-sm-2" id="s" placeholder="{% trans "Search" %}" aria-label="{% trans "Search" %}" type="search"  autofocus="autofocus" name="q" >
  </form>
  <ul class="navbar-nav flex-row align-items-center flex-grow-1 justify-content-between">
     <li class="nav-item ">
        <a class="nav-link pl-2 pr-2" href="{% url 'video_edit' %}"><i data-feather="plus-square" aria-hidden="true" class="nav-link-icone d-lg-none d-xl-inline"></i>  <span class="d-none d-md-inline-block">{% trans "Add a video" %}</span></a>
      </li>
      {% if user.is_authenticated %}
      <li class="nav-item dropdown login">
        <button class="initials nav-link pl-2 pr-2 dropdown-toggle d-flex justify-content-center align-items-center " href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
        {% if user.first_name != '' and user.last_name != '' %}{{ user.first_name|first|upper }}{{ user.last_name|first|upper }}{% else %}{{ user.username|slice:":2"}}{% endif %}
        </button>
        <div class="dropdown-menu dropdown-menu-right" aria-labelledby="Profil">
          <span class="dropdown-item" >{% if user.get_full_name != '' %}{{ user.get_full_name }}{% else %}{{ user.username }}{% endif %}</span>
          <div class="dropdown-divider"></div>
          {% if request.user.is_superuser  %}
          <a class="dropdown-item" href="{% url 'admin:index' %}"><i data-feather="cpu"></i>&nbsp;Administration</a>
          {% endif %}
          {% if request.user.is_staff or request.user.is_superuser %}
          {% if request.user.owner.userpicture  %}
          <button class="btn btn-link dropdown-item get_form_userpicture" data-url="{% url "userpicture" %}">
              <img src="{{user.owner.userpicture.file.url}}" height="34" class='rounded' alt="{{user}}">
              {% trans 'Change your picture' %}</button>
          {% else %}
          <button class="btn btn-link dropdown-item get_form_userpicture"  data-url="{% url "userpicture" %}">
              <i data-feather="image"></i>&nbsp;{% trans 'Add your picture' %}</button>
          {% endif %}
          {% endif %}
          <a class="dropdown-item" href="{% url 'my_videos' %}" title="{% trans 'My videos' %}"><i data-feather="film"></i>&nbsp;{% trans 'My videos' %}</a>
          {% if request.user.owners_channels.all %}
          <a class="dropdown-item" href="{% url 'my_channels' %}" title="{% trans 'My channels' %}"><i data-feather="youtube"></i>&nbsp;{% trans 'My channels' %}</a>
          {% endif %}
          <a class="dropdown-item" href="{% url 'my_playlists' %}" title="{% trans 'My playlists' %}"><i data-feather="airplay"></i>&nbsp;Mes playlists</a>
          <!-- <a class="dropdown-item" href="#">Gestion de mon compte</a> -->
          <div class="dropdown-divider"></div>
          <a class="dropdown-item" href="{% url 'authentication_logout' %}" title="{% trans 'Log out' %}">
              <i data-feather="log-out"></i>&nbsp;{% trans 'Log out' %}</a>
        </div>
      </li>
      {% else %}
      <li class="nav-item dropdown login">
        <button class="btn btn-connexion nav-link pl-2 pr-2 d-flex justify-content-center" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          Connexion
        </button>
      </li>
      {% endif %}
      <li class="nav-item d-none d-lg-block">
        <div class="btn-group"><button type="button" class="btn btn-lang btn-lang-active my-2 mr-sm-2 dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            {{LANGUAGE_CODE}}
            </button>
        <div class="dropdown-menu dropdown-menu-right p-0 m-0">
        {% for language in languages %}
        {% if language.code != LANGUAGE_CODE %}
        <form class="form form-inline dropdown-item p-0 m-0" action="/i18n/setlang/" method="post">
          {% csrf_token %}
          <input name="language" value="{{ language.code }}" type="hidden">
          <input value="{{ language.name_local }} ({{ language.code }})" class="btn btn-lang my-2 mr-sm-2" type="submit">
        </form>
        {% endif %}
        {% endfor %}
        </div>
        </div>
      </li>
   </ul>
</div> <!-- FIN Container -->
{% endspaceless %}    
    