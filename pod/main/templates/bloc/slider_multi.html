{% load i18n %}
{% load video_filters static %}


{% if videos_list.count >= 1 %}
	<div class="pod-inner edito-slider-multi ">	
		<h2>{{ title |capfirst|truncatechars:43 }}</h2>	
		{% if auto_slide %}
		  <div id="carousel_{{container.slug}}_{{ uniq_id }}" class="carousel carousel-multi slide" data-bs-ride="carousel">
		{% else %}
		  <div id="carousel_{{container.slug}}_{{ uniq_id }}" class="carousel carousel-multi slide" data-bs-ride="false">
		{% endif %}	
		
		
            <div class="carousel-inner" role="listbox">
				{% for video in videos_list.list %}
					{% if forloop.first %}
					<div class="carousel-item active">
					{% else %}
					<div class="carousel-item">
					{% endif %}	
						<div class="col-md-{% widthratio 12 slider_multi_nb_card 1 %}">
							<div class="card">
								<a href="{{video.get_absolute_url}}" title="{{video.title}}"> 
									<div class="card-img">									
										<img src="{{ video.get_thumbnail_url }}" class="img-fluid">
									</div>
									<div class="carousel-caption d-none d-md-block">
										<h5 class="video_title">{{video.title|capfirst|truncatechars:43}}</h4>
										<p class="video_desc text-muted">{{ video.description|metaformat|safe|striptags|truncatechars:250}}</p>
										<small class="video_time text-muted time d-none d-md-block">{{video.duration_in_time}}</small>						
									</div>							
								</a>
							</div>
						</div>
					</div>
				{% endfor %}
			</div>
			
			{% if videos_list.count > slider_multi_nb_card %}
			<button class="carousel-control-prev" type="button" data-bs-target="#carousel_{{container.slug}}_{{ uniq_id }}" data-bs-slide="prev">
				<span class="carousel-control-prev-icon" aria-hidden="true"></span>
				<span class="visually-hidden">Previous</span>
			</button>
			<button class="carousel-control-next" type="button" data-bs-target="#carousel_{{container.slug}}_{{ uniq_id }}" data-bs-slide="next">
				<span class="carousel-control-next-icon" aria-hidden="true"></span>
				<span class="visually-hidden">Next</span>
			</button>
			{% endif %}
		</div>

		
	</div>
	
	<script type="text/javascript">
	
	$('#carousel_{{container.slug}}_{{ uniq_id }}').ready(function() {
		let items = document.querySelectorAll('#carousel_{{container.slug}}_{{ uniq_id }} .carousel-item')

		items.forEach((el) => {
			const minPerSlide = {{ slider_multi_nb_card }}
			let next = el.nextElementSibling
			for (var i=1; i<minPerSlide; i++) {
				if (!next) {
					// wrap carousel by using first child
					next = items[0]
				}
				let cloneChild = next.cloneNode(true)
				el.appendChild(cloneChild.children[0])
				next = next.nextElementSibling
			}
		})

	});

	</script>

{% endif %}
	
